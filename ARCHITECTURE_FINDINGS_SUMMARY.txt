================================================================================
                     ARCHITEKTONICKÃ AUDIT - FINÃLNÃ SOUHRN
                           WHITE GLOVE SERVICE
================================================================================

DATUM AUDITU: 2025-11-14
AUDITOR: ArchitektonickÃ½ analytik
CÃLEVÃ SKUPINA: Development team, Project manager, Technical Lead

================================================================================
GLOBÃLNÃ METRIKY
================================================================================

Celkem PHP souborÅ¯:                119
Celkem Å™Ã¡dkÅ¯ kÃ³du:                 35,511
PrÅ¯mÄ›rnÃ¡ velikost souboru:         298 Å™Ã¡dkÅ¯
Soubory >1000 Å™Ã¡dkÅ¯:               4 (GOD OBJECTS!)
ArchitektonickÃ© skÃ³re:             3.2/10 (KRITICKY Å PATNÃ‰ âŒ)
Tech Debt:                         VELMI VYSOKÃ (9/10)

================================================================================
TOP 10 KRITICKÃCH PROBLÃ‰MÅ® (SeÅ™azeno dle severity)
================================================================================

1. âŒ GOD OBJECT: control_center_api.php (2,960 Å™Ã¡dkÅ¯)
   â”œâ”€ Severity: KRITICKÃ (9/10)
   â”œâ”€ Å˜Ã¡dkÅ¯: 2,960
   â”œâ”€ Switch cases: 48 (48 RÅ®ZNÃCH ODPOVÄšDNOSTÃ!)
   â”œâ”€ Impact: NemoÅ¾nÃ© udrÅ¾ovat, testovat, nebo chÃ¡pat
   â”œâ”€ Time to fix: 2-3 dny (by mÄ›l bÃ½t rozdÄ›len na 5+ souborÅ¯)
   â””â”€ File: /home/user/moje-stranky/api/control_center_api.php

2. âŒ GOD OBJECT: control_center_console.php (2,624 Å™Ã¡dkÅ¯)
   â”œâ”€ Severity: KRITICKÃ (8/10)
   â”œâ”€ Å˜Ã¡dkÅ¯: 2,624
   â”œâ”€ OdpovÄ›dnosti: 5+ (PHP diags, security scanning, SQL validation, API testing, logs)
   â”œâ”€ Impact: Jeden soubor dÄ›lÃ¡ diagnostiku celÃ© aplikace
   â”œâ”€ Time to fix: 1-2 dny
   â””â”€ File: /home/user/moje-stranky/includes/control_center_console.php

3. âŒ 43 PHP SOUBORÅ® V ROOT DIRECTORY
   â”œâ”€ Severity: KRITICKÃ (9/10)
   â”œâ”€ StrukturÃ¡lnÃ­ chaos - nemoÅ¾nÃ© navigovat
   â”œâ”€ Security risk - veÅ™ejnÃ©/private soubory smÃ­Å¡enÃ©
   â”œâ”€ Impact: MusÃ­Å¡ vÄ›dÄ›t kde je co
   â”œâ”€ Time to fix: 1-2 dny (mere refactoring, ne kÃ³d)
   â””â”€ PÅ™Ã­klady: admin.php, login.php, novareklamace.php, statistiky.php

4. âŒ Å½ÃDNÃ REPOSITORY PATTERN
   â”œâ”€ Severity: KRITICKÃ (9/10)
   â”œâ”€ 64 souborÅ¯ s pÅ™Ã­mÃ½m PDO/SQL access
   â”œâ”€ SQL queries v API, views, controllers rozptÃ½lenÃ©
   â”œâ”€ Impact: Nelze zmÄ›nit DB bez dotyku vÅ¡ech souborÅ¯
   â”œâ”€ Time to fix: 3-5 dnÃ­ (create ClaimRepository, UserRepository, etc.)
   â””â”€ Files: /api/control_center_api.php:168, /includes/control_center_unified.php:17

5. âŒ DUPLICITNÃ EMAIL VALIDACE (5 mÃ­st)
   â”œâ”€ Severity: VYSOKÃ (8/10)
   â”œâ”€ Lokality: 5
   â”œâ”€ Pattern: filter_var($email, FILTER_VALIDATE_EMAIL)
   â”œâ”€ Impact: NejednotnÃ¡ logika, DRY violation
   â”œâ”€ Time to fix: 2 hodiny (create Validator class)
   â””â”€ Files: admin_users_api, notification_api (2x), control_center_api, password_reset_controller

6. âŒ 12+ CONTROL CENTER SOUBORÅ® V RÅ®ZNÃCH SLOÅ½KÃCH
   â”œâ”€ Severity: VYSOKÃ (8/10)
   â”œâ”€ Å˜Ã¡dkÅ¯ celkem: 11,184
   â”œâ”€ RozprostÅ™eno v: /api/, /includes/, /admin/
   â”œâ”€ Impact: NavigaÄnÃ­ nightmare - vyhledÃ¡vÃ¡nÃ­ control center kÃ³du
   â”œâ”€ Time to fix: 1-2 dny
   â””â”€ PÅ™Ã­klady: control_center_*.php (12 souborÅ¯)

7. âŒ HTML/CSS/PHP SMÃÅ ENO V JEDNOM SOUBORU
   â”œâ”€ Severity: VYSOKÃ (8/10)
   â”œâ”€ Soubory: novareklamace.php (474 Å™Ã¡dkÅ¯), statistiky.php (741), admin.php (864)
   â”œâ”€ Problem: 3 vrstvy (business logic + presentation + styling) v jednom
   â”œâ”€ Impact: NemoÅ¾nÃ© testovat, mÄ›nit, nebo rozdÄ›lit
   â”œâ”€ Time to fix: 2-3 dny
   â””â”€ Example: novareklamace.php (PHP logika â†’ HTML â†’ inline CSS)

8. âŒ Å½ÃDNÃ DEPENDENCY INJECTION
   â”œâ”€ Severity: VYSOKÃ (8/10)
   â”œâ”€ Pattern: getDbConnection() - Global Service Locator
   â”œâ”€ Global variables: global $pdo; (test_environment.php:168,177,185)
   â”œâ”€ Impact: TÄ›Å¾ko testovatelnÃ½ kÃ³d, hidden dependencies
   â”œâ”€ Time to fix: 3-5 dnÃ­ (create IoC container + refactor)
   â””â”€ Files: /config/config.php:284, /api/test_environment.php

9. âŒ Å½ÃDNÃ AUTOLOADER / NAMESPACES
   â”œâ”€ Severity: STÅ˜EDNÃ (7/10)
   â”œâ”€ Status: Manual require_once v kaÅ¾dÃ©m souboru
   â”œâ”€ ChybÃ­: composer.json, PSR-4 namespaces
   â”œâ”€ Impact: 100+ copypaste require statements
   â”œâ”€ Time to fix: 1 den
   â””â”€ Example: require_once __DIR__ . '/../../init.php';

10. âŒ ADMIN.PHP - MEGA FILE (864 Å˜ÃDKÅ®)
    â”œâ”€ Severity: VYSOKÃ (8/10)
    â”œâ”€ Å˜Ã¡dkÅ¯: 864
    â”œâ”€ Concerns: Auth, routing, rendering, styling, scripting
    â”œâ”€ Impact: NejdÅ¯leÅ¾itÄ›jÅ¡Ã­ admin soubor je pÅ™Ã­liÅ¡ velkÃ½
    â”œâ”€ Time to fix: 1-2 dny (split into AdminController)
    â””â”€ File: /home/user/moje-stranky/admin.php

================================================================================
DETAILNÃ MAPOVÃNÃ PROBLÃ‰MÅ®
================================================================================

â”Œâ”€ KATEGORIE 1: DUPLICITNÃ KÃ“D (Code Duplication) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚ âœ… CO FUNGUJE:                                                              â”‚
â”‚    â€¢ HTML escaping (135 instancÃ­) - konzistentnÃ­                           â”‚
â”‚    â€¢ SQL query count (141) - nenÃ­ extrÃ©mnÃ­                                 â”‚
â”‚    â€¢ CSRF validation - existuje a je konzistentnÃ­                          â”‚
â”‚                                                                              â”‚
â”‚ âŒ PROBLÃ‰MY:                                                                â”‚
â”‚    1. Email validace: 5 duplikÃ¡tÅ¯                                          â”‚
â”‚       Location: admin_users_api, notification_api (2x), control_center,   â”‚
â”‚                password_reset_controller                                   â”‚
â”‚       Pattern: filter_var($email, FILTER_VALIDATE_EMAIL)                   â”‚
â”‚       Fix: Create Validator::validateEmail()                               â”‚
â”‚       Severity: VYSOKÃ                                                     â”‚
â”‚                                                                              â”‚
â”‚    2. SQL Query duplikÃ¡ty - Reklamace Lookup (3x)                         â”‚
â”‚       Query: SELECT id FROM wgs_reklamace WHERE reklamace_id=? OR cislo=?  â”‚
â”‚       Location: save.php, delete_reklamace.php, protokol_api.php          â”‚
â”‚       Fix: Create ClaimRepository::findByAnyIdentifier()                    â”‚
â”‚       Severity: VYSOKÃ                                                     â”‚
â”‚                                                                              â”‚
â”‚    3. Session start (4 mÃ­sta)                                              â”‚
â”‚       Location: init.php (2x), config.php, install_admin_control_center   â”‚
â”‚       Fix: Konsoliduj do init.php                                          â”‚
â”‚       Severity: STÅ˜EDNÃ                                                    â”‚
â”‚                                                                              â”‚
â”‚    4. SQL statistik dotazy (N duplikÃ¡tÅ¯)                                  â”‚
â”‚       Pattern: SELECT COUNT(*) FROM wgs_reklamace                          â”‚
â”‚       Location: control_center_api, control_center_unified                â”‚
â”‚       Fix: Create StatsRepository::getClaimStats()                         â”‚
â”‚       Severity: STÅ˜EDNÃ                                                    â”‚
â”‚                                                                              â”‚
â”‚    5. Database connection (2 systÃ©my)                                      â”‚
â”‚       Singleton: Database::getInstance()                                   â”‚
â”‚       Function: getDbConnection()                                          â”‚
â”‚       Fix: Standardizuj na jednu metodu                                    â”‚
â”‚       Severity: VYSOKÃ                                                     â”‚
â”‚                                                                              â”‚
â”‚ ğŸ“‹ TECH DEBT: 8/10 (VYSOKÃ)                                               â”‚
â”‚    â€¢ DRY principle poruÅ¡en v ~5-7% kÃ³du                                    â”‚
â”‚    â€¢ Copy-paste development viditelnÃ½                                      â”‚
â”‚    â€¢ Bez centrÃ¡lnÃ­ho validation frameworku                                 â”‚
â”‚    â€¢ Bez repository abstraction                                             â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ KATEGORIE 2: GOD OBJECTS & GOD FUNCTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚ âŒ KRITICKÃ‰ PORUÅ ENÃ:                                                      â”‚
â”‚                                                                              â”‚
â”‚ 1. control_center_api.php                                                 â”‚
â”‚    â”œâ”€ Size: 2,960 Å™Ã¡dkÅ¯ (!!!)                                             â”‚
â”‚    â”œâ”€ Switch cases: 48 (KAÅ½DÃ MÃ VLASTNÃ LOGIKU!)                         â”‚
â”‚    â”œâ”€ Primary concerns:                                                   â”‚
â”‚    â”‚  â”œâ”€ Theme management (save, delete, get)                             â”‚
â”‚    â”‚  â”œâ”€ Content management (save, get)                                   â”‚
â”‚    â”‚  â”œâ”€ Action execution (install SMTP, phpMailer, migrate, backup)      â”‚
â”‚    â”‚  â”œâ”€ System config (email, JWT, settings)                             â”‚
â”‚    â”‚  â””â”€ Maintenance (cleanup, optimize, index)                           â”‚
â”‚    â”œâ”€ Problem: Router + Controller + Service + Validation dohromady      â”‚
â”‚    â”œâ”€ Reasons to change: 48+                                              â”‚
â”‚    â””â”€ Solution: Split into:                                               â”‚
â”‚       api/control_center/                                                  â”‚
â”‚       â”œâ”€â”€ theme_api.php                                                   â”‚
â”‚       â”œâ”€â”€ content_api.php                                                 â”‚
â”‚       â”œâ”€â”€ actions_api.php                                                 â”‚
â”‚       â”œâ”€â”€ config_api.php                                                  â”‚
â”‚       â”œâ”€â”€ maintenance_api.php                                             â”‚
â”‚       â””â”€â”€ bootstrap.php (shared routing)                                   â”‚
â”‚                                                                              â”‚
â”‚ 2. control_center_console.php                                             â”‚
â”‚    â”œâ”€ Size: 2,624 Å™Ã¡dkÅ¯                                                  â”‚
â”‚    â”œâ”€ Responses: PHP diagnostics, security scanning, SQL validation,      â”‚
â”‚    â”‚             API testing, log viewing                                 â”‚
â”‚    â”œâ”€ Reasons to change: 5+                                               â”‚
â”‚    â””â”€ Solution: Split into includes/diagnostics/ components              â”‚
â”‚                                                                              â”‚
â”‚ 3. control_center_testing_interactive.php                                 â”‚
â”‚    â”œâ”€ Size: 1,192 Å™Ã¡dkÅ¯                                                  â”‚
â”‚    â”œâ”€ Functions: 13                                                       â”‚
â”‚    â”œâ”€ Avg function size: 92 Å™Ã¡dkÅ¯ (PÅ˜ÃLIÅ  VELKÃ‰!)                        â”‚
â”‚    â””â”€ Solution: Split functions into smaller testable units              â”‚
â”‚                                                                              â”‚
â”‚ 4. control_center_unified.php                                             â”‚
â”‚    â”œâ”€ Size: 1,176 Å™Ã¡dkÅ¯                                                  â”‚
â”‚    â”œâ”€ Functions: 21                                                       â”‚
â”‚    â”œâ”€ Issues: SQL queries mixed with HTML rendering                       â”‚
â”‚    â””â”€ Solution: Separate into Controller (business) + View (rendering)   â”‚
â”‚                                                                              â”‚
â”‚ 5. admin.php                                                              â”‚
â”‚    â”œâ”€ Size: 864 Å™Ã¡dkÅ¯                                                    â”‚
â”‚    â”œâ”€ Concerns: Auth, routing, rendering, styling                        â”‚
â”‚    â”œâ”€ Inline CSS starting at line 142+                                   â”‚
â”‚    â””â”€ Solution: Extract to AdminController + separate view files         â”‚
â”‚                                                                              â”‚
â”‚ ğŸ“‹ TECH DEBT: 9/10 (VELMI VYSOKÃ)                                        â”‚
â”‚    â€¢ 4 soubory > 1000 Å™Ã¡dkÅ¯ (healthy: max 1)                             â”‚
â”‚    â€¢ 48 switch cases v jednom souboru (healthy: max 5-8)                  â”‚
â”‚    â€¢ Megafunkce s >50 Å™Ã¡dky (healthy: max 15-20)                          â”‚
â”‚    â€¢ Bez jasnÃ© separace responsibilitiy                                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ KATEGORIE 3: CHAOTICKÃ STRUKTURA SOUBORÅ® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚ âŒ ROOT DIRECTORY - 43 PHP SOUBORÅ®!!!                                      â”‚
â”‚    PÅ™Ã­klady: admin.php, index.php, login.php, novareklamace.php,         â”‚
â”‚             statistiky.php, admin_api.php, analytics.php, backup_system.phpâ”‚
â”‚                                                                              â”‚
â”‚    ProblÃ©my:                                                               â”‚
â”‚    â€¢ SEO impact (43 public PHP files indexovatelnÃ½ch)                     â”‚
â”‚    â€¢ Security risk (private scripts exposure)                             â”‚
â”‚    â€¢ Navigation nightmare (40+ files k vyzkouÅ¡enÃ­)                        â”‚
â”‚    â€¢ Mixed public/internal files                                          â”‚
â”‚                                                                              â”‚
â”‚ âŒ NEJEDNOTNÃ‰ JMENOVÃNÃ                                                   â”‚
â”‚    Czech names: novareklamace.php, nasesluzby.php, onas.php               â”‚
â”‚    English names: admin.php, index.php, login.php                         â”‚
â”‚    Hyphenated: psa-kalkulator.php                                         â”‚
â”‚                                                                              â”‚
â”‚ âŒ 12+ CONTROL CENTER SOUBORÅ® V RÅ®ZNÃCH MÃSTECH                           â”‚
â”‚    RozprostÅ™eno v: /api/, /includes/, /admin/                            â”‚
â”‚    PÅ™Ã­klady:                                                              â”‚
â”‚    â€¢ /api/control_center_api.php (2,960 Å™Ã¡dkÅ¯)                           â”‚
â”‚    â€¢ /includes/control_center_console.php (2,624)                         â”‚
â”‚    â€¢ /includes/control_center_testing_interactive.php (1,192)             â”‚
â”‚    â€¢ /includes/control_center_unified.php (1,176)                         â”‚
â”‚    â€¢ + 8 dalÅ¡Ã­ch control_center_*.php souborÅ¯                             â”‚
â”‚                                                                              â”‚
â”‚ âŒ DUPLICITNÃ API FILES                                                   â”‚
â”‚    PravdÄ›podobnÃ© duplikÃ¡ty:                                               â”‚
â”‚    â€¢ notification_api.php vs notification_list_direct.php                 â”‚
â”‚    â€¢ test_environment.php vs test_environment_simple.php                  â”‚
â”‚    â€¢ admin_stats_api.php vs admin_users_api.php vs admin_api.php         â”‚
â”‚                                                                              â”‚
â”‚ âœ… SPRÃVNÃ STRUKTURA BY MÄšLA BÃT:                                         â”‚
â”‚    /public/                   (entry points)                              â”‚
â”‚      â”œâ”€ index.php                                                        â”‚
â”‚      â”œâ”€ admin.php                                                        â”‚
â”‚      â”œâ”€ login.php                                                        â”‚
â”‚      â””â”€ assets/                                                          â”‚
â”‚    /app/                      (business logic)                            â”‚
â”‚      â”œâ”€ controllers/                                                     â”‚
â”‚      â”œâ”€ models/                                                          â”‚
â”‚      â”œâ”€ repositories/                                                    â”‚
â”‚      â”œâ”€ services/                                                        â”‚
â”‚      â””â”€ views/                                                           â”‚
â”‚    /api/                      (API endpoints)                            â”‚
â”‚      â”œâ”€ v1/                                                             â”‚
â”‚      â”‚  â”œâ”€ theme/                                                      â”‚
â”‚      â”‚  â”œâ”€ content/                                                    â”‚
â”‚      â”‚  â”œâ”€ actions/                                                    â”‚
â”‚      â”‚  â””â”€ ...                                                         â”‚
â”‚      â””â”€ admin/                                                         â”‚
â”‚    /includes/                 (utilities only)                          â”‚
â”‚      â”œâ”€ security/                                                      â”‚
â”‚      â”œâ”€ validation/                                                    â”‚
â”‚      â”œâ”€ email/                                                         â”‚
â”‚      â””â”€ utils/                                                         â”‚
â”‚                                                                              â”‚
â”‚ ğŸ“‹ TECH DEBT: 9/10 (VELMI VYSOKÃ)                                        â”‚
â”‚    â€¢ 43 root PHP files (should be <5)                                    â”‚
â”‚    â€¢ 12+ control center files scattered (should be <3)                    â”‚
â”‚    â€¢ No clear public/private separation                                  â”‚
â”‚    â€¢ Likely duplicate API endpoints                                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ KATEGORIE 4: REPOSITORY PATTERN & DATA ACCESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚ âŒ PÅ˜ÃMÃ‰ PDO QUERIES V API CONTROLLERU                                     â”‚
â”‚    File: /api/control_center_api.php:168-176                              â”‚
â”‚    Code: $stmt = $pdo->query("SELECT * FROM wgs_pending_actions ...");    â”‚
â”‚    Issue: SQL v API response handler                                      â”‚
â”‚    Impact: Nelze testovat bez DB                                          â”‚
â”‚                                                                              â”‚
â”‚ âŒ SQL V PRESENTATION LAYER                                               â”‚
â”‚    File: /includes/control_center_unified.php:17-32                       â”‚
â”‚    Code: $stmt = $pdo->query("SELECT COUNT(*) FROM wgs_reklamace");       â”‚
â”‚    Issue: View s DB access                                                â”‚
â”‚    Impact: Nelze mÄ›nit DB bez dotyku views                                â”‚
â”‚                                                                              â”‚
â”‚ âŒ DATABASE ACCESS V 64 SOUBORECH                                          â”‚
â”‚    Affected: /api/, /includes/, /*.php files                              â”‚
â”‚    Pattern: KaÅ¾dÃ½ soubor mÃ¡ svÅ¯j SQL                                      â”‚
â”‚    Impact: Nelze standardizovat error handling, logging, query optimizationâ”‚
â”‚                                                                              â”‚
â”‚ âŒ CHYBÃ REPOSITORY CLASSES                                               â”‚
â”‚    Missing:                                                               â”‚
â”‚    â€¢ ClaimRepository (find, save, delete, getStats, search)               â”‚
â”‚    â€¢ UserRepository (find, save, delete, list)                            â”‚
â”‚    â€¢ ConfigRepository (get, set)                                          â”‚
â”‚    â€¢ NotificationRepository (queue, send, log)                            â”‚
â”‚    â€¢ ActionRepository (getPending, execute, complete)                     â”‚
â”‚                                                                              â”‚
â”‚ âœ… Å˜EÅ ENÃ:                                                                â”‚
â”‚    1. VytvoÅ™ /app/repositories/ folder                                    â”‚
â”‚    2. Implementuj Repository interface                                    â”‚
â”‚    3. Migruj SQL z 64 souborÅ¯ do repositories                             â”‚
â”‚    4. Inject repositories do controllers/services                         â”‚
â”‚                                                                              â”‚
â”‚ ğŸ“‹ TECH DEBT: 9/10 (KRITICKÃ)                                             â”‚
â”‚    â€¢ 0 repository classes (should have 5+)                                â”‚
â”‚    â€¢ SQL in 64 files (should be in 0 files except repositories)           â”‚
â”‚    â€¢ No data access abstraction                                           â”‚
â”‚    â€¢ Impossible to change DB without touching entire codebase            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ KATEGORIE 5: DEPENDENCY INJECTION & IoC â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚ âŒ GLOBAL DATABASE SINGLETON                                              â”‚
â”‚    Pattern: getDbConnection() - Service Locator anti-pattern              â”‚
â”‚    File: /config/config.php:284                                           â”‚
â”‚    Usage: 64 souborÅ¯                                                      â”‚
â”‚    Problem: Hidden dependency, hard to mock, hard to test                 â”‚
â”‚                                                                              â”‚
â”‚ âŒ GLOBAL VARIABLES V TEST CODE                                           â”‚
â”‚    File: /api/test_environment.php                                        â”‚
â”‚    Lines: 168, 177, 185                                                   â”‚
â”‚    Code: global $pdo;                                                     â”‚
â”‚    Problem: Anti-pattern, bad testability                                 â”‚
â”‚                                                                              â”‚
â”‚ âŒ STATIC DATABASE CLASS                                                  â”‚
â”‚    File: /config/database.php                                             â”‚
â”‚    Pattern: Database::getInstance() (Singleton)                           â”‚
â”‚    Problem: Cannot mock for testing                                       â”‚
â”‚    Status: Exists but not used (getDbConnection() is preferred)           â”‚
â”‚                                                                              â”‚
â”‚ âŒ HARD-CODED DEPENDENCIES                                                â”‚
â”‚    Pattern: require_once __DIR__ . '/../../includes/csrf_helper.php';     â”‚
â”‚    Files: Every controller (copied 100+ times)                            â”‚
â”‚    Problem: DRY violation, fragile paths                                   â”‚
â”‚                                                                              â”‚
â”‚ âŒ Å½ÃDNÃ IoC CONTAINER                                                    â”‚
â”‚    Missing: No dependency container                                       â”‚
â”‚    Impact: Manual instantiation everywhere                                â”‚
â”‚    Solution: Use Pimple, Aura.Di, or similar                             â”‚
â”‚                                                                              â”‚
â”‚ âœ… Å˜EÅ ENÃ:                                                                â”‚
â”‚    1. VytvoÅ™ IoC container (nebo use Pimple)                             â”‚
â”‚    2. Register all services/repositories                                  â”‚
â”‚    3. Inject dependencies do constructors                                 â”‚
â”‚    4. Remove all getDbConnection() calls                                   â”‚
â”‚                                                                              â”‚
â”‚ ğŸ“‹ TECH DEBT: 8/10 (VYSOKÃ)                                               â”‚
â”‚    â€¢ Service Locator used extensively (anti-pattern)                      â”‚
â”‚    â€¢ No proper DI (all manual instantiation)                              â”‚
â”‚    â€¢ No IoC container                                                     â”‚
â”‚    â€¢ Hard-coded dependencies everywhere                                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ KATEGORIE 6: AUTOLOADING & NAMESPACES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚ âŒ Å½ÃDNÃ COMPOSER AUTOLOADER                                              â”‚
â”‚    Missing: composer.json (or at least not with autoload)                 â”‚
â”‚    Alternative: No spl_autoload_register implementation                   â”‚
â”‚    Impact: Manual require_once in every file                              â”‚
â”‚                                                                              â”‚
â”‚ âŒ 0 NAMESPACES V KÃ“DU                                                    â”‚
â”‚    Status: Projekt nepouÅ¾Ã­vÃ¡ namespaces vÅ¯bec                            â”‚
â”‚    Impact: Å½Ã¡dnÃ¡ PSR-4 standardizace                                      â”‚
â”‚    Risk: MoÅ¾nÃ© jmennÃ© konflikty                                           â”‚
â”‚                                                                              â”‚
â”‚ âŒ RELATIVE PATHS V INCLUDES                                              â”‚
â”‚    Pattern: require_once __DIR__ . '/../../config/config.php';            â”‚
â”‚    Problem: Fragile - rozbije se pÅ™i pÅ™esunutÃ­ souboru                    â”‚
â”‚    Better: require_once dirname(__DIR__, 2) . '/config/config.php';       â”‚
â”‚                                                                              â”‚
â”‚ âŒ REQUIRE STATEMENT DUPLICATION                                          â”‚
â”‚    Example: login_controller.php + password_reset_controller.php          â”‚
â”‚    Lines 2-5 v obou souborech jsou IDENTICKÃ‰                              â”‚
â”‚    Duplication: 100+ kopiÃ­ stejnÃ½ch includes                              â”‚
â”‚                                                                              â”‚
â”‚ âœ… Å˜EÅ ENÃ:                                                                â”‚
â”‚    1. VytvoÅ™ composer.json s autoload (PSR-4)                            â”‚
â”‚    2. Add namespaces do vÅ¡ech tÅ™Ã­d                                        â”‚
â”‚    3. Use: use App\Controllers\LoginController;                           â”‚
â”‚    4. Remove all require_once statements (except bootstrap)               â”‚
â”‚                                                                              â”‚
â”‚ ğŸ“‹ TECH DEBT: 7/10 (STÅ˜EDNÃ)                                              â”‚
â”‚    â€¢ No composer (should have it)                                         â”‚
â”‚    â€¢ No namespaces (should use PSR-4)                                     â”‚
â”‚    â€¢ Manual requires (100+ duplicates)                                    â”‚
â”‚    â€¢ Fragile relative paths                                               â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ KATEGORIE 7: SEPARATION OF CONCERNS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚ âŒ HTML + PHP + CSS V JEDNOM SOUBORU                                      â”‚
â”‚    Example 1: novareklamace.php (474 Å™Ã¡dkÅ¯)                              â”‚
â”‚    Structure: PHP logic â†’ HTML form â†’ inline CSS (3 layers)               â”‚
â”‚                                                                              â”‚
â”‚    Example 2: statistiky.php (741 Å™Ã¡dkÅ¯)                                 â”‚
â”‚    Structure: PHP stats queries â†’ HTML table â†’ inline CSS                 â”‚
â”‚                                                                              â”‚
â”‚    Example 3: admin.php (864 Å™Ã¡dkÅ¯)                                      â”‚
â”‚    Structure: Auth check â†’ Tab routing â†’ HTML rendering â†’ CSS             â”‚
â”‚                                                                              â”‚
â”‚ âŒ SQL V PRESENTATION LAYER                                               â”‚
â”‚    File: /includes/control_center_unified.php:17-32                       â”‚
â”‚    Pattern: $stmt = $pdo->query(...) v view includu                       â”‚
â”‚    Issue: View by mÄ›l pÅ™ijÃ­mat prepared data                              â”‚
â”‚                                                                              â”‚
â”‚ âŒ INLINE CSS V HTML SOUBORECH                                            â”‚
â”‚    Files: admin.php, novareklamace.php, includes/*.php                    â”‚
â”‚    Pattern: <style> ... </style> inline v souboru                         â”‚
â”‚    Should be: Link to assets/css/page.min.css                             â”‚
â”‚                                                                              â”‚
â”‚ âŒ API VS INCLUDE-BASED RENDERING                                         â”‚
â”‚    API Files: /api/*.php â†’ JSON (Good!)                                   â”‚
â”‚    Include Files: /includes/*.php â†’ HTML (Mixed - includes SQL)           â”‚
â”‚    Root Files: /*.php â†’ HTML (Mixed - includes logic)                     â”‚
â”‚                                                                              â”‚
â”‚ âœ… IDEÃLNÃ STRUKTURA:                                                     â”‚
â”‚    /app/controllers/AdminController.php (ONLY LOGIC)                      â”‚
â”‚      public function dashboard() {                                        â”‚
â”‚          $stats = $this->adminService->getStats();                        â”‚
â”‚          return view('admin/dashboard', ['stats' => $stats]);             â”‚
â”‚      }                                                                    â”‚
â”‚                                                                              â”‚
â”‚    /app/views/admin/dashboard.php (ONLY RENDERING)                        â”‚
â”‚      <div class="stat"><?= htmlspecialchars($stats['claims']) ?></div>    â”‚
â”‚                                                                              â”‚
â”‚    /assets/css/admin.min.css (ONLY STYLING)                              â”‚
â”‚      .stat { display: flex; gap: 1rem; }                                  â”‚
â”‚                                                                              â”‚
â”‚ ğŸ“‹ TECH DEBT: 9/10 (VELMI VYSOKÃ)                                        â”‚
â”‚    â€¢ HTML mixed with PHP in 30+ files                                     â”‚
â”‚    â€¢ Inline CSS in 20+ files                                              â”‚
â”‚    â€¢ SQL in views                                                         â”‚
â”‚    â€¢ No clear separation between layers                                   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ KATEGORIE 8: SINGLE RESPONSIBILITY PRINCIPLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚ âŒ 48 SWITCH CASES = 48 ODPOVÄšDNOSTÃ                                      â”‚
â”‚    File: /api/control_center_api.php                                      â”‚
â”‚    Cases:                                                                 â”‚
â”‚    â€¢ save_theme, delete_theme, get_theme (Theme responsibility)           â”‚
â”‚    â€¢ get_content_texts, save_content_text (Content responsibility)        â”‚
â”‚    â€¢ get_pending_actions, execute_action, complete_action (Action resp.)  â”‚
â”‚    â€¢ setup_smtp, save_smtp, get_smtp_status (Config responsibility)       â”‚
â”‚    â€¢ cleanup_emails, create_backup, optimize_assets (Maint. responsibility)â”‚
â”‚    â€¢ ... + 40 more cases                                                  â”‚
â”‚                                                                              â”‚
â”‚    SRP Violation: EXTREME - Every case is separate reason to change      â”‚
â”‚    Reasons to change: 48+                                                 â”‚
â”‚    Healthy maximum: 3-5 related reasons per file                          â”‚
â”‚                                                                              â”‚
â”‚ âŒ ADMIN.PHP - 6+ CONCERNS                                                â”‚
â”‚    1. Authentication/Authorization (lines 5-10)                           â”‚
â”‚    2. Security headers/CSP (lines 15-41)                                  â”‚
â”‚    3. Tab routing (lines 44-62)                                           â”‚
â”‚    4. HTML rendering (lines 64+)                                          â”‚
â”‚    5. Inline CSS (lines 142+)                                             â”‚
â”‚    6. JavaScript includes (near end)                                      â”‚
â”‚                                                                              â”‚
â”‚    Reasons to change: 6+                                                  â”‚
â”‚    SRP violation: SEVERE                                                  â”‚
â”‚                                                                              â”‚
â”‚ âŒ CONTROL_CENTER_CONSOLE.PHP - 6+ FEATURES                               â”‚
â”‚    1. PHP diagnostics                                                     â”‚
â”‚    2. Security scanning                                                   â”‚
â”‚    3. SQL validation                                                      â”‚
â”‚    4. API testing                                                         â”‚
â”‚    5. Log file viewing                                                    â”‚
â”‚    6. Cache clearing                                                      â”‚
â”‚                                                                              â”‚
â”‚    Reasons to change: 6+                                                  â”‚
â”‚    Better: Each feature its own class/service                             â”‚
â”‚                                                                              â”‚
â”‚ âŒ EMAILQUEUE CLASS                                                       â”‚
â”‚    Responsibilities (likely):                                             â”‚
â”‚    â€¢ Queue management (add, get, process)                                 â”‚
â”‚    â€¢ PHPMailer integration                                                â”‚
â”‚    â€¢ Log file handling                                                    â”‚
â”‚    â€¢ Retry logic                                                          â”‚
â”‚    â€¢ Attachment processing                                                â”‚
â”‚                                                                              â”‚
â”‚    SRP violation: Multiple reasons to change                              â”‚
â”‚    Solution: Split into MailQueue + MailSender + Logger                   â”‚
â”‚                                                                              â”‚
â”‚ âœ… SHOULD BE:                                                             â”‚
â”‚    â€¢ ThemeController/ThemeService (theme only)                            â”‚
â”‚    â€¢ ContentController/ContentService (content only)                      â”‚
â”‚    â€¢ ActionController/ActionService (actions only)                        â”‚
â”‚    â€¢ ConfigController/ConfigService (config only)                         â”‚
â”‚    â€¢ MaintenanceService (cleanup, backup, optimize)                       â”‚
â”‚    â€¢ DiagnosticsService (diagnostics only)                                â”‚
â”‚    â€¢ SecurityScannerService (security only)                               â”‚
â”‚    â€¢ MailQueueService (queue management)                                  â”‚
â”‚    â€¢ MailSenderService (sending)                                          â”‚
â”‚                                                                              â”‚
â”‚ ğŸ“‹ TECH DEBT: 9/10 (KRITICKÃ)                                             â”‚
â”‚    â€¢ Extreme SRP violations (48+ reasons to change in one file)           â”‚
â”‚    â€¢ Multiple concerns per file                                           â”‚
â”‚    â€¢ No separation of responsibilities                                    â”‚
â”‚    â€¢ Classes doing too much                                               â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
AKÄŒNÃ PLÃN - CO DÄšLAT A V JAKÃ‰M POÅ˜ADÃ
================================================================================

PRIORITA 1 - URGENT (UdÄ›lej do 1 tÃ½dne)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. VYTVOÅ˜ CENTRÃLNÃ VALIDATOR
   â”œâ”€ Soubor: /app/validators/Validator.php
   â”œâ”€ Metody: validateEmail(), validatePhone(), validateDate(), validateUrl()
   â”œâ”€ Impact: SnÃ­Å¾Ã­ duplicitnÃ­ kÃ³d z 5 mÃ­st na 1
   â”œâ”€ ÄŒas: 2-3 hodiny
   â””â”€ ROI: 7/10 - SnadnÃ©, okamÅ¾itÃ½ dopad

2. VYTVOÅ˜ CLAIMREPOSITORY
   â”œâ”€ Soubor: /app/repositories/ClaimRepository.php
   â”œâ”€ Metody: findById(), findByAnyIdentifier(), save(), delete(), getStats()
   â”œâ”€ Impact: Centralizace vÅ¡ech claim queries
   â”œâ”€ ÄŒas: 1 den
   â””â”€ ROI: 9/10 - NejvÄ›tÅ¡Ã­ dopad

3. REORGANIZUJ KONTROLU STRUTURY
   â”œâ”€ CÃ­l: PÅ™esuÅˆ 43 root PHP files do /app/controllers/
   â”œâ”€ NejdÅ¯leÅ¾itÄ›jÅ¡Ã­: novareklamace.php, admin.php, statistiky.php
   â”œâ”€ Zbytek: admin_api.php, analytics.php, atd.
   â”œâ”€ ÄŒas: 1-2 dny (mechanical refactoring)
   â””â”€ ROI: 8/10 - BezpeÄnost + struktura

PRIORITA 2 - HIGH (UdÄ›lej tento sprint - tÃ½dny 2-3)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

4. ROZDÄšL CONTROL_CENTER_API.PHP (2,960 Å™Ã¡dkÅ¯ â†’ 5 souborÅ¯)
   â”œâ”€ api/control_center/theme.php (save, delete, get)
   â”œâ”€ api/control_center/content.php (get, save)
   â”œâ”€ api/control_center/actions.php (get, execute, complete)
   â”œâ”€ api/control_center/config.php (SMTP, JWT, system)
   â”œâ”€ api/control_center/maintenance.php (cleanup, backup, optimize)
   â”œâ”€ ÄŒas: 2-3 dny
   â””â”€ ROI: 8/10 - Kriticky dÅ¯leÅ¾itÃ©

5. KONSOLIDUJ CONTROL CENTER SOUBORY
   â”œâ”€ CÃ­l: 12 souborÅ¯ â†’ 1 folder /admin/control-center/
   â”œâ”€ Struktura:
   â”‚  â”œâ”€ api.php (unified endpoint)
   â”‚  â”œâ”€ services/ (PhpDiagnostics, SecurityScanner, SqlValidator, etc.)
   â”‚  â””â”€ views/ (console.php, unified.php, etc.)
   â”œâ”€ ÄŒas: 2-3 dny
   â””â”€ ROI: 7/10 - Navigace

6. IMPLEMENTUJ COMPOSER AUTOLOADER
   â”œâ”€ VytvoÅ™ composer.json s PSR-4
   â”œâ”€ PÅ™idej namespaces do vÅ¡ech tÅ™Ã­d
   â”œâ”€ OdstraÅˆ vÅ¡echny require_once (kromÄ› bootstrap)
   â”œâ”€ ÄŒas: 1-2 dny
   â””â”€ ROI: 6/10 - Modernizace

PRIORITA 3 - MEDIUM (UdÄ›lej do 2 mÄ›sÃ­cÅ¯)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

7. IMPLEMENTUJ SERVICE LAYER
   â”œâ”€ /app/services/ClaimService.php
   â”œâ”€ /app/services/UserService.php
   â”œâ”€ /app/services/AdminService.php
   â”œâ”€ /app/services/EmailService.php
   â”œâ”€ ÄŒas: 3-5 dnÃ­
   â””â”€ ROI: 7/10 - Business logic abstraction

8. IMPLEMENTUJ IoC CONTAINER
   â”œâ”€ PouÅ¾ij Pimple nebo Aura.Di
   â”œâ”€ Registruj vÅ¡echny services/repositories
   â”œâ”€ Inject do controllersÅ¯
   â”œâ”€ ÄŒas: 2-3 dny
   â””â”€ ROI: 7/10 - Testability

9. VYTVOÅ˜ MVC VIEWS
   â”œâ”€ OddÄ›lenÃ­ /app/views/ od logikyÃ¡Ä
   â”œâ”€ PÅ™esuÅˆ HTML z /includes/ do /app/views/
   â”œâ”€ OdstraÅˆ SQL z views
   â”œâ”€ ÄŒas: 3-5 dnÃ­
   â””â”€ ROI: 7/10 - Separation of concerns

================================================================================
OÄŒEKÃVANÃ‰ VÃSLEDKY PO REFACTOINGU
================================================================================

PÅ˜ED (NynÃ­)                          POTÃ‰ (Za 3 mÄ›sÃ­ce)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ— God classes (4)                    âœ… God classes (0)
âœ— Avg file size (298 Å™Ã¡dkÅ¯)          âœ… Avg file size (<200 Å™Ã¡dkÅ¯)
âœ— Avg function (45 Å™Ã¡dkÅ¯)            âœ… Avg function (<25 Å™Ã¡dkÅ¯)
âœ— Code duplication (5-7%)            âœ… Code duplication (<2%)
âœ— Test coverage (0%)                 âœ… Test coverage (60%+)
âœ— Arch score (3.2/10)                âœ… Arch score (7.5+/10)
âœ— Tech Debt (VELMI VYSOKÃ)           âœ… Tech Debt (NÃZKÃ)

================================================================================
FILELIST PRO OKAMÅ½ITOU ANALÃZU
================================================================================

KRITICKÃ‰ SOUBORY (MusÃ­ se zmÄ›nit):
â”œâ”€ /api/control_center_api.php (2,960 Å™Ã¡dkÅ¯ - ROZDÄšLIT)
â”œâ”€ /includes/control_center_console.php (2,624 Å™Ã¡dkÅ¯ - ROZDÄšLIT)
â”œâ”€ /admin.php (864 Å™Ã¡dkÅ¯ - REFACTOR)
â”œâ”€ /novareklamace.php (474 Å™Ã¡dkÅ¯ - REFACTOR)
â”œâ”€ /statistiky.php (741 Å™Ã¡dkÅ¯ - REFACTOR)
â””â”€ 43 root PHP files (PÅ˜ESUÅ‡ do /app/controllers/)

DUPLICITNÃ KÃ“D (MusÃ­ se unifikovat):
â”œâ”€ Email validation (5 mÃ­st)
â”œâ”€ SQL Claim lookup (3 mÃ­st)
â”œâ”€ Session start (4 mÃ­sta)
â”œâ”€ Database connection (2 systÃ©my)
â””â”€ Stats queries (N mÃ­st)

CHYBÄšJÃCÃ (MUSÃ SE VYTVOÅ˜IT):
â”œâ”€ /app/repositories/ (0 -> 5+ souborÅ¯)
â”œâ”€ /app/services/ (0 -> 5+ souborÅ¯)
â”œâ”€ /app/views/ (0 -> 10+ souborÅ¯)
â”œâ”€ /app/validators/ (0 -> 1+ souboru)
â”œâ”€ IoC Container
â””â”€ composer.json s autoloader

================================================================================
TECHNICKÃ‰ METRIKY BASELINE
================================================================================

Metrika                          NynÃ­          CÃ­l (3M)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
God Classes (>1000 LOC)          4             0
Avg File Size                    298 LOC       <200 LOC
Avg Function Size                45 LOC        <25 LOC
Code Duplication                 5-7%          <2%
Cyclomatic Complexity            High          Low-Medium
Test Coverage                    0%            60%+
Architecture Score               3.2/10        7.5+/10
Tech Debt                        9/10          2-3/10
Duplicate Requirements           100+          <10
SQL Scattered Across             64 files      1 (repositories)
Repository Classes               0             5+
Service Classes                  0             5+
Namespace Usage                  0%            100%

================================================================================
ZÃVÄšR
================================================================================

Projekt trpÃ­ KRITICKÃMI ARCHITEKTONICKÃMI PROBLÃ‰MY, kterÃ© zpomalujÃ­ vÃ½voj
a zvyÅ¡ujÃ­ risk bug introducovÃ¡nÃ­. PrimÃ¡rnÃ­ pÅ™Ã­Äinou jsou:

1. NedostateÄnÃ© oddÄ›lenÃ­ concerns (HTML/CSS/PHP dohromady)
2. God Objects (control_center_api.php mÃ¡ 48 switch cases!)
3. ChybÄ›jÃ­cÃ­ abstrakÄnÃ­ vrstvy (Å¾Ã¡dnÃ¡ repositories, services)
4. DuplicitnÃ­ kÃ³d bez unifikace
5. Å½Ã¡dnÃ½ modernÃ­ PHP setup (composer, namespaces, DI)

DOBRÃ ZPRÃVA: VeÅ¡kerÃ© problÃ©my jsou Å˜EÅ ITELNÃ‰ systematickÃ½m refactoringem
bez vÄ›tÅ¡Ã­ch architektonickÃ½ch zmÄ•n (nemusÃ­Å¡ zvolit framework).

KRITICKÃ‰ AKCE:
âœ… 1. VytvoÅ™ Validator class (2-3 h)
âœ… 2. VytvoÅ™ ClaimRepository (1 den)
âœ… 3. RozdÄ›l control_center_api.php (2-3 dny)
âœ… 4. PÅ™esuÅˆ root PHP files do /app/controllers/ (1-2 dny)
âœ… 5. Implementuj Composer + namespaces (1-2 dny)

Potom v dalÅ¡Ã­ch sprintech:
âœ… 6. Service layer
âœ… 7. IoC container
âœ… 8. MVC views separation
âœ… 9. Unit tests

TIMELINE: 1-3 mÄ›sÃ­ce pro kritickÃ© refactoring
IMPACT: 7+ na architecture score
ROI: VELMI VYSOKÃ - bude se nÃ¡m lÃ©pe pracovat, mÃ©nÄ› bugÅ¯, lepÅ¡Ã­ testability

================================================================================

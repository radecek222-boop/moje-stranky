!function(){"use strict";async function o(o){o.preventDefault();try{let o=null;const e=document.querySelector('input[name="csrf_token"]');if(e&&e.value&&(o=e.value),!o)try{const e=new AbortController,t=setTimeout(()=>e.abort(),5e3),n=await fetch("/app/controllers/get_csrf_token.php",{credentials:"same-origin",signal:e.signal});clearTimeout(t);const r=await n.json();"success"!==r.status&&!0!==r.success||!r.token||(o=r.token)}catch(o){console.error("CSRF token fetch failed:",o),"AbortError"===o.name&&console.error("CSRF token fetch timeout (5s)")}if(!o)return alert("Nepodařilo se získat bezpečnostní token. Obnovte stránku a zkuste to znovu."),void(window.location.href="/logout.php");const t=document.createElement("form");t.method="POST",t.action="/logout.php";const n=document.createElement("input");n.type="hidden",n.name="csrf_token",n.value=o,t.appendChild(n),document.body.appendChild(t),t.submit()}catch(o){console.error("Logout error:",o),alert("Chyba při odhlašování. Zkuste to prosím znovu."),window.location.href="/logout.php"}}function e(){const e=['a[href="logout.php"]','a[href="/logout.php"]',"a.logout-link","a.hamburger-logout","#logoutBtn","#logoutBtnDesktop"];let t=[];try{t=document.querySelectorAll(e.join(", "))}catch(o){console.error("Logout handler selector error:",o),t=document.querySelectorAll("#logoutBtn, #logoutBtnDesktop")}t.forEach(e=>{e.addEventListener("click",o)}),t.length>0&&console.log(`[Logout] Handler: ${t.length} logout links protected`)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),window.secureLogout=o}();
//# sourceMappingURL=logout-handler.min.js.map
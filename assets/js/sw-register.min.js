!function(){"use strict";let e=null;document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&e&&e.update().catch(()=>{})});let t=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{t||(t=!0,console.log("[PWA] Nový SW aktivován - reload"),window.location.reload())}),"serviceWorker"in navigator&&window.addEventListener("load",async function(){try{e=await navigator.serviceWorker.register("/sw.php",{scope:"/",updateViaCache:"none"}),console.log("[PWA] Service Worker registrován"),e.addEventListener("updatefound",()=>{const t=e.installing;console.log("[PWA] Nová verze nalezena"),t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&(console.log("[PWA] Aktivuji novou verzi..."),t.postMessage("SKIP_WAITING"))})}),setInterval(()=>{e&&e.update().catch(()=>{})},3e5)}catch(e){console.error("[PWA] Chyba registrace SW:",e)}}),window.vynutitAktualizaci=async function(){console.log("[PWA] Vynucuji aktualizaci...");const e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)));const t=await navigator.serviceWorker.getRegistrations();await Promise.all(t.map(e=>e.unregister())),window.location.reload(!0)}}();
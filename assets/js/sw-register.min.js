!function(){"use strict";if(!("serviceWorker"in navigator))return void console.log("[PWA] Service Worker není podporován");let e=!1,n=null;const o=/iPad|iPhone|iPod/.test(navigator.userAgent),a=window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone,t=o&&a?6e4:3e5;async function i(){if(n)try{await n.update()}catch(e){}}window.addEventListener("load",async()=>{try{n=await navigator.serviceWorker.register("/sw.js",{scope:"/",updateViaCache:"none"}),console.log("[PWA] Service Worker registrován:",n.scope),await i(),n.addEventListener("updatefound",()=>{const e=n.installing;console.log("[PWA] Nalezena nová verze Service Workeru..."),e.addEventListener("statechange",()=>{"installed"===e.state&&navigator.serviceWorker.controller&&(console.log("[PWA] Nová verze připravena k aktivaci"),o&&a?(console.log("[PWA] iOS PWA - automaticka aktivace"),n&&n.waiting&&n.waiting.postMessage("SKIP_WAITING")):function(){if(document.getElementById("pwa-update-banner"))return;const e=document.createElement("div");e.id="pwa-update-banner",e.innerHTML='\n      <div style="\n        position: fixed;\n        bottom: 20px;\n        left: 50%;\n        transform: translateX(-50%);\n        background: #222;\n        color: #fff;\n        padding: 16px 24px;\n        border-radius: 8px;\n        box-shadow: 0 4px 20px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        gap: 16px;\n        z-index: 10003;\n        font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;\n        font-size: 14px;\n        max-width: 90vw;\n      ">\n        <span>Je dostupná nová verze aplikace</span>\n        <button id="pwa-update-btn" style="\n          background: #fff;\n          color: #222;\n          border: none;\n          padding: 8px 16px;\n          border-radius: 4px;\n          font-weight: 600;\n          cursor: pointer;\n          white-space: nowrap;\n        ">Aktualizovat</button>\n        <button id="pwa-dismiss-btn" style="\n          background: transparent;\n          color: #999;\n          border: none;\n          padding: 8px;\n          cursor: pointer;\n          font-size: 18px;\n          line-height: 1;\n        ">&times;</button>\n      </div>\n    ',document.body.appendChild(e),document.getElementById("pwa-update-btn").addEventListener("click",()=>{navigator.serviceWorker.ready.then(e=>{e.waiting&&e.waiting.postMessage("SKIP_WAITING")}),e.remove()}),document.getElementById("pwa-dismiss-btn").addEventListener("click",()=>{e.remove()})}())})}),setInterval(i,t)}catch(e){console.error("[PWA] Chyba registrace Service Workeru:",e)}}),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&n&&(console.log("[PWA] Stranka viditelna - kontroluji aktualizace"),i())}),window.addEventListener("focus",()=>{n&&i()}),navigator.serviceWorker.addEventListener("controllerchange",()=>{e||(e=!0,console.log("[PWA] Nový Service Worker aktivován, reloaduji..."),window.location.reload())}),navigator.serviceWorker.addEventListener("message",e=>{"SW_UPDATED"===e.data.type&&console.log("[PWA] Service Worker aktualizován na verzi:",e.data.version)}),window.zkontrolujAktualizace=async function(){if(!navigator.serviceWorker.controller)return void console.log("[PWA] Žádný aktivní Service Worker");const e=await navigator.serviceWorker.ready;console.log("[PWA] Kontroluji aktualizace..."),await e.update(),console.log("[PWA] Kontrola dokončena")},window.vynutitAktualizaci=async function(){console.log("[PWA] Vynucuji aktualizaci...");const e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)));const n=await navigator.serviceWorker.getRegistrations();await Promise.all(n.map(e=>e.unregister())),console.log("[PWA] Cache smazán, reloaduji..."),window.location.reload(!0)}}();
//# sourceMappingURL=sw-register.min.js.map
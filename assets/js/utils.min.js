function isSuccess(e){return!(!e||!0!==e.success&&"success"!==e.status)}async function safeFetchJson(e,t={}){try{const n=await fetch(e,{credentials:"same-origin",...t});if(!n.ok){let e=`HTTP ${n.status}: ${n.statusText}`;try{const t=await n.json();e=t.message||t.error||e}catch(e){}throw new Error(e)}return await n.json()}catch(e){throw e}}function safeSetIframeSrc(e,t){if(!e)return void console.error("[Utils] safeSetIframeSrc: iframe element not found");(e.dataset.src||"")!==t&&(e.src=t,e.dataset.src=t,e.dataset.loaded="true")}function escapeHtml(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function getCSRFTokenFromMeta(){const e=document.querySelector('meta[name="csrf-token"]');return e?e.getAttribute("content"):(console.error("[Utils] CSRF token meta tag not found!"),null)}function formatDateCZ(e){if(!e)return"—";try{const t="string"==typeof e?new Date(e):e;return isNaN(t.getTime())?"—":t.toLocaleDateString("cs-CZ")}catch(e){return"—"}}function formatDateTimeCZ(e){if(!e)return"—";try{const t="string"==typeof e?new Date(e):e;return isNaN(t.getTime())?"—":t.toLocaleString("cs-CZ")}catch(e){return"—"}}function escapeRegex(e){return e?e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"):""}function highlightText(e,t){if(!t||!e)return escapeHtml(e);const n=escapeHtml(e),o=escapeRegex(t),s=new RegExp(`(${o})`,"gi");return n.replace(s,'<span class="highlight">$1</span>')}function debounce(e,t){let n;return function(...o){clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),e(...o)},t)}}async function fetchCsrfToken(){if("function"==typeof getCSRFToken)try{const e=await getCSRFToken();if(e)return e}catch(e){"undefined"!=typeof logger&&logger?.warn&&logger.warn("CSRF token z getCSRFToken selhal:",e)}if("function"==typeof getCSRFTokenFromMeta){const e=getCSRFTokenFromMeta();if(e)return e}const e=document.querySelector('meta[name="csrf-token"]');if(e){const t=e.getAttribute("content");if(t)return window.csrfTokenCache=t,t}throw new Error("CSRF token není k dispozici. Obnovte stránku a zkuste to znovu.")}"undefined"!=typeof module&&module.exports&&(module.exports={isSuccess:isSuccess,safeFetchJson:safeFetchJson,safeSetIframeSrc:safeSetIframeSrc,escapeHtml:escapeHtml,getCSRFTokenFromMeta:getCSRFTokenFromMeta,formatDateCZ:formatDateCZ,formatDateTimeCZ:formatDateTimeCZ,escapeRegex:escapeRegex,highlightText:highlightText,debounce:debounce,fetchCsrfToken:fetchCsrfToken}),window.Utils=window.Utils||{},window.Utils.escapeHtml=escapeHtml,window.Utils.escapeRegex=escapeRegex,window.Utils.highlightText=highlightText,window.Utils.debounce=debounce,window.Utils.fetchCsrfToken=fetchCsrfToken,void 0===window.debounce&&(window.debounce=debounce),void 0===window.escapeHtml&&(window.escapeHtml=escapeHtml),window.fetchCsrfToken=fetchCsrfToken;const ActionRegistry={handlers:{},register(e,t){this.handlers[e]=t},execute(e,t){const n=this.handlers[e];return!!n&&(n(t,t.dataset),!0)}};function initEventDelegation(){document.addEventListener("click",function(e){const t=e.target.closest("[data-action]");if(t){const n=t.dataset.action;"true"===t.dataset.stopPropagation&&e.stopPropagation(),ActionRegistry.execute(n,t)&&e.preventDefault()}const n=e.target.closest("[data-href]");if(n&&!e.target.closest("a")){e.preventDefault();const t=n.dataset.href;t&&(window.location.href=t)}}),document.addEventListener("change",function(e){const t=e.target.closest("[data-action]");if(t){const e=t.dataset.action;ActionRegistry.execute(e,t)}})}function wgsConfirm(e,t="OK",n="Zrušit"){return new Promise(o=>{const s=document.createElement("div");s.className="wgs-confirm-overlay",s.setAttribute("role","dialog"),s.setAttribute("aria-modal","true"),s.setAttribute("aria-labelledby","wgs-confirm-message");const c=document.createElement("div");c.className="wgs-confirm-dialog";const i=document.createElement("p");i.id="wgs-confirm-message",i.className="wgs-confirm-message",i.textContent=e;const r=document.createElement("div");r.className="wgs-confirm-buttons";const a=document.createElement("button");a.type="button",a.className="wgs-confirm-btn wgs-confirm-cancel",a.textContent=n;const d=document.createElement("button");function u(e){document.removeEventListener("keydown",f),s.remove(),o(e)}function f(e){"Escape"===e.key?u(!1):"Enter"===e.key&&u(!0)}d.type="button",d.className="wgs-confirm-btn wgs-confirm-ok",d.textContent=t,r.appendChild(a),r.appendChild(d),c.appendChild(i),c.appendChild(r),s.appendChild(c),d.addEventListener("click",()=>u(!0)),a.addEventListener("click",()=>u(!1)),s.addEventListener("click",e=>{e.target===s&&u(!1)}),document.addEventListener("keydown",f),document.body.appendChild(s),d.focus()})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initEventDelegation):initEventDelegation(),window.Utils.ActionRegistry=ActionRegistry,window.Utils.registerAction=ActionRegistry.register.bind(ActionRegistry),window.wgsConfirm=wgsConfirm,window.Utils.wgsConfirm=wgsConfirm;
//# sourceMappingURL=utils.min.js.map
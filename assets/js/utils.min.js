function isSuccess(e){return!(!e||!0!==e.success&&"success"!==e.status)}async function safeFetchJson(e,t={}){try{const n=await fetch(e,{credentials:"same-origin",...t});if(!n.ok){let e=`HTTP ${n.status}: ${n.statusText}`;try{const t=await n.json();e=t.message||t.error||e}catch(e){}throw new Error(e)}return await n.json()}catch(e){throw e}}function safeSetIframeSrc(e,t){if(!e)return void console.error("[Utils] safeSetIframeSrc: iframe element not found");(e.dataset.src||"")!==t&&(e.src=t,e.dataset.src=t,e.dataset.loaded="true")}function escapeHtml(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function getCSRFTokenFromMeta(){const e=document.querySelector('meta[name="csrf-token"]');return e?e.getAttribute("content"):(console.error("[Utils] CSRF token meta tag not found!"),null)}function formatDateCZ(e){if(!e)return"—";try{const t="string"==typeof e?new Date(e):e;return isNaN(t.getTime())?"—":t.toLocaleDateString("cs-CZ")}catch(e){return"—"}}function formatDateTimeCZ(e){if(!e)return"—";try{const t="string"==typeof e?new Date(e):e;return isNaN(t.getTime())?"—":t.toLocaleString("cs-CZ")}catch(e){return"—"}}function escapeRegex(e){return e?e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"):""}function highlightText(e,t){if(!t||!e)return escapeHtml(e);const n=escapeHtml(e),o=escapeRegex(t),s=new RegExp(`(${o})`,"gi");return n.replace(s,'<span class="highlight">$1</span>')}function debounce(e,t){let n;return function(...o){clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),e(...o)},t)}}async function fetchCsrfToken(){if("function"==typeof getCSRFToken)try{const e=await getCSRFToken();if(e)return e}catch(e){"undefined"!=typeof logger&&logger?.warn&&logger.warn("CSRF token z getCSRFToken selhal:",e)}if("function"==typeof getCSRFTokenFromMeta){const e=getCSRFTokenFromMeta();if(e)return e}const e=document.querySelector('meta[name="csrf-token"]');if(e){const t=e.getAttribute("content");if(t)return window.csrfTokenCache=t,t}throw new Error("CSRF token není k dispozici. Obnovte stránku a zkuste to znovu.")}"undefined"!=typeof module&&module.exports&&(module.exports={isSuccess:isSuccess,safeFetchJson:safeFetchJson,safeSetIframeSrc:safeSetIframeSrc,escapeHtml:escapeHtml,getCSRFTokenFromMeta:getCSRFTokenFromMeta,formatDateCZ:formatDateCZ,formatDateTimeCZ:formatDateTimeCZ,escapeRegex:escapeRegex,highlightText:highlightText,debounce:debounce,fetchCsrfToken:fetchCsrfToken}),window.Utils=window.Utils||{},window.Utils.escapeHtml=escapeHtml,window.Utils.escapeRegex=escapeRegex,window.Utils.highlightText=highlightText,window.Utils.debounce=debounce,window.Utils.fetchCsrfToken=fetchCsrfToken,void 0===window.debounce&&(window.debounce=debounce),void 0===window.escapeHtml&&(window.escapeHtml=escapeHtml),window.fetchCsrfToken=fetchCsrfToken;const ActionRegistry={handlers:{},register(e,t){this.handlers[e]=t},execute(e,t){const n=this.handlers[e];return!!n&&(n(t,t.dataset),!0)}};function initEventDelegation(){document.addEventListener("click",function(e){const t=e.target.closest("[data-action]");if(t){const n=t.dataset.action;"true"===t.dataset.stopPropagation&&e.stopPropagation(),ActionRegistry.execute(n,t)&&e.preventDefault()}const n=e.target.closest("[data-href]");if(n&&!e.target.closest("a")){e.preventDefault();const t=n.dataset.href;t&&(window.location.href=t)}}),document.addEventListener("change",function(e){const t=e.target.closest("[data-action]");if(t){const e=t.dataset.action;ActionRegistry.execute(e,t)}})}function wgsConfirm(e,t="OK",n="Zrušit"){return new Promise(o=>{const s=document.createElement("div");s.className="wgs-confirm-overlay",s.setAttribute("role","dialog"),s.setAttribute("aria-modal","true"),s.setAttribute("aria-labelledby","wgs-confirm-message");const a=document.createElement("div");a.className="wgs-confirm-dialog";const i=document.createElement("p");i.id="wgs-confirm-message",i.className="wgs-confirm-message",i.textContent=e;const c=document.createElement("div");c.className="wgs-confirm-buttons";const r=document.createElement("button");r.type="button",r.className="wgs-confirm-btn wgs-confirm-cancel",r.textContent=n;const d=document.createElement("button");function l(e){document.removeEventListener("keydown",u),s.remove(),o(e)}function u(e){"Escape"===e.key?l(!1):"Enter"===e.key&&l(!0)}d.type="button",d.className="wgs-confirm-btn wgs-confirm-ok",d.textContent=t,c.appendChild(r),c.appendChild(d),a.appendChild(i),a.appendChild(c),s.appendChild(a),d.addEventListener("click",()=>l(!0)),r.addEventListener("click",()=>l(!1)),s.addEventListener("click",e=>{e.target===s&&l(!1)}),document.addEventListener("keydown",u),document.body.appendChild(s),d.focus()})}function wgsToast(e,t="info",n=3e3){let o=document.getElementById("wgs-toast-container");o||(o=document.createElement("div"),o.id="wgs-toast-container",o.className="wgs-toast-container",document.body.appendChild(o));const s=document.createElement("div");s.className=`wgs-toast wgs-toast-${t}`,s.setAttribute("role","alert"),s.setAttribute("aria-live","error"===t?"assertive":"polite");const a=document.createElement("span");a.className="wgs-toast-message",a.textContent=e;const i=document.createElement("button");function c(){s.classList.remove("wgs-toast-visible"),s.classList.add("wgs-toast-hiding"),setTimeout(()=>{s.remove(),o&&0===o.children.length&&o.remove()},300)}return i.type="button",i.className="wgs-toast-close",i.innerHTML="&times;",i.setAttribute("aria-label","Zavřít"),s.appendChild(a),s.appendChild(i),o.appendChild(s),requestAnimationFrame(()=>{s.classList.add("wgs-toast-visible")}),i.addEventListener("click",c),n>0&&setTimeout(c,n),s}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initEventDelegation):initEventDelegation(),window.Utils.ActionRegistry=ActionRegistry,window.Utils.registerAction=ActionRegistry.register.bind(ActionRegistry),window.wgsConfirm=wgsConfirm,window.Utils.wgsConfirm=wgsConfirm,wgsToast.success=(e,t)=>wgsToast(e,"success",t),wgsToast.error=(e,t)=>wgsToast(e,"error",t||5e3),wgsToast.warning=(e,t)=>wgsToast(e,"warning",t||4e3),wgsToast.info=(e,t)=>wgsToast(e,"info",t),window.wgsToast=wgsToast,window.Utils.wgsToast=wgsToast;
//# sourceMappingURL=utils.min.js.map
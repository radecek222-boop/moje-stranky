function isSuccess(t){return!(!t||!0!==t.success&&"success"!==t.status)}async function safeFetchJson(t,e={}){try{const n=await fetch(t,{credentials:"same-origin",...e});if(!n.ok){let t=`HTTP ${n.status}: ${n.statusText}`;try{const e=await n.json();t=e.message||e.error||t}catch(t){}throw new Error(t)}return await n.json()}catch(t){throw t}}function safeSetIframeSrc(t,e){if(!t)return void console.error("[Utils] safeSetIframeSrc: iframe element not found");(t.dataset.src||"")!==e&&(t.src=e,t.dataset.src=e,t.dataset.loaded="true")}function escapeHtml(t){if(!t)return"";const e=document.createElement("div");return e.textContent=t,e.innerHTML}function getCSRFTokenFromMeta(){const t=document.querySelector('meta[name="csrf-token"]');return t?t.getAttribute("content"):(console.error("[Utils] CSRF token meta tag not found!"),null)}function formatDateCZ(t){if(!t)return"—";const e=["ne","po","ut","st","ct","pa","so"];try{const n="string"==typeof t?new Date(t):t;if(isNaN(n.getTime()))return"—";const o=e[n.getDay()],s=n.getDate(),i=n.getMonth()+1;return`${o} ${s}.${i}.${n.getFullYear()}`}catch(t){return"—"}}function formatDateTimeCZ(t){if(!t)return"—";const e=["ne","po","ut","st","ct","pa","so"];try{const n="string"==typeof t?new Date(t):t;if(isNaN(n.getTime()))return"—";const o=e[n.getDay()],s=n.getDate(),i=n.getMonth()+1,r=n.getFullYear(),a=n.getHours().toString().padStart(2,"0");return`${o} ${s}.${i}.${r} ${a}:${n.getMinutes().toString().padStart(2,"0")}`}catch(t){return"—"}}function escapeRegex(t){return t?t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"):""}function highlightText(t,e){if(!e||!t)return escapeHtml(t);const n=escapeHtml(t),o=escapeRegex(e),s=new RegExp(`(${o})`,"gi");return n.replace(s,'<span class="highlight">$1</span>')}function debounce(t,e){let n;return function(...o){clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),t(...o)},e)}}async function fetchCsrfToken(){if("function"==typeof getCSRFToken)try{const t=await getCSRFToken();if(t)return t}catch(t){"undefined"!=typeof logger&&logger?.warn&&logger.warn("CSRF token z getCSRFToken selhal:",t)}if("function"==typeof getCSRFTokenFromMeta){const t=getCSRFTokenFromMeta();if(t)return t}const t=document.querySelector('meta[name="csrf-token"]');if(t){const e=t.getAttribute("content");if(e)return window.csrfTokenCache=e,e}throw new Error("CSRF token není k dispozici. Obnovte stránku a zkuste to znovu.")}"undefined"!=typeof module&&module.exports&&(module.exports={isSuccess:isSuccess,safeFetchJson:safeFetchJson,safeSetIframeSrc:safeSetIframeSrc,escapeHtml:escapeHtml,getCSRFTokenFromMeta:getCSRFTokenFromMeta,formatDateCZ:formatDateCZ,formatDateTimeCZ:formatDateTimeCZ,escapeRegex:escapeRegex,highlightText:highlightText,debounce:debounce,fetchCsrfToken:fetchCsrfToken}),window.Utils=window.Utils||{},window.Utils.escapeHtml=escapeHtml,window.Utils.escapeRegex=escapeRegex,window.Utils.highlightText=highlightText,window.Utils.debounce=debounce,window.Utils.fetchCsrfToken=fetchCsrfToken,void 0===window.debounce&&(window.debounce=debounce),void 0===window.escapeHtml&&(window.escapeHtml=escapeHtml),window.fetchCsrfToken=fetchCsrfToken;const ActionRegistry={handlers:{},register(t,e){this.handlers[t]=e},execute(t,e){const n=this.handlers[t];return!!n&&(n(e,e.dataset),!0)}};function initEventDelegation(){document.addEventListener("click",function(t){const e=t.target.closest("[data-action]");if(e){const n=e.dataset.action;"true"===e.dataset.stopPropagation&&t.stopPropagation(),ActionRegistry.execute(n,e)&&t.preventDefault()}const n=t.target.closest("[data-href]");if(n&&!t.target.closest("a")){t.preventDefault();const e=n.dataset.href;e&&(window.location.href=e)}}),document.addEventListener("change",function(t){const e=t.target.closest("[data-action]");if(e){const t=e.dataset.action;ActionRegistry.execute(t,e)}})}function wgsConfirm(t,e={},n){return new Promise(o=>{let s={};s="string"==typeof e?{btnPotvrdit:e,btnZrusit:n||"Zrušit"}:e;const{titulek:i="Potvrzení",btnPotvrdit:r="Potvrdit",btnZrusit:a="Zrušit",nebezpecne:c=!1}=s,d=document.getElementById("wgsConfirmModal");d&&d.remove();const l=document.createElement("div");l.id="wgsConfirmModal",l.className="wgs-confirm-overlay",l.setAttribute("role","dialog"),l.setAttribute("aria-modal","true"),l.setAttribute("aria-labelledby","wgs-confirm-title"),l.style.cssText="\n            position: fixed; top: 0; left: 0; right: 0; bottom: 0;\n            background: rgba(0,0,0,0.7); display: flex;\n            align-items: center; justify-content: center; z-index: 10001;\n        ";const g=c?"background: #dc3545; color: #fff;":"background: #fff; color: #000;";l.innerHTML=`\n            <div class="wgs-confirm-dialog" style="background: #1a1a1a; padding: 25px; border-radius: 12px;\n                        max-width: 400px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.5);\n                        border: 1px solid #333; font-family: 'Poppins', sans-serif;">\n                <h3 id="wgs-confirm-title" style="margin: 0 0 15px 0; color: #fff; font-size: 1.1rem; font-weight: 600;">${escapeHtml(i)}</h3>\n                <p id="wgs-confirm-message" class="wgs-confirm-message" style="margin: 0 0 20px 0; color: #ccc; font-size: 0.95rem; line-height: 1.5;">${escapeHtml(t)}</p>\n                <div class="wgs-confirm-buttons" style="display: flex; gap: 10px; justify-content: flex-end;">\n                    <button type="button" id="wgsConfirmBtnZrusit" class="wgs-confirm-btn wgs-confirm-cancel"\n                            style="padding: 10px 20px; border: 1px solid #444; border-radius: 6px;\n                                   background: transparent; color: #ccc; cursor: pointer; font-size: 0.9rem;\n                                   font-family: 'Poppins', sans-serif;">${escapeHtml(a)}</button>\n                    <button type="button" id="wgsConfirmBtnPotvrdit" class="wgs-confirm-btn wgs-confirm-ok"\n                            style="padding: 10px 20px; border: none; border-radius: 6px; ${g}\n                                   cursor: pointer; font-size: 0.9rem; font-weight: 500;\n                                   font-family: 'Poppins', sans-serif;">${escapeHtml(r)}</button>\n                </div>\n            </div>\n        `,document.body.appendChild(l);const u=t=>{l.remove(),document.removeEventListener("keydown",w),o(t)};document.getElementById("wgsConfirmBtnZrusit")?.addEventListener("click",()=>u(!1)),document.getElementById("wgsConfirmBtnPotvrdit")?.addEventListener("click",()=>u(!0)),l.addEventListener("click",t=>{t.target===l&&u(!1)});const w=t=>{"Escape"===t.key&&u(!1)};document.addEventListener("keydown",w),document.getElementById("wgsConfirmBtnZrusit")?.focus()})}function wgsToast(t,e="info",n=3e3){let o=document.getElementById("wgs-toast-container");o||(o=document.createElement("div"),o.id="wgs-toast-container",o.className="wgs-toast-container",document.body.appendChild(o));const s=document.createElement("div");s.className=`wgs-toast wgs-toast-${e}`,s.setAttribute("role","alert"),s.setAttribute("aria-live","error"===e?"assertive":"polite");const i=document.createElement("span");i.className="wgs-toast-message",i.textContent=t;const r=document.createElement("button");function a(){s.classList.remove("wgs-toast-visible"),s.classList.add("wgs-toast-hiding"),setTimeout(()=>{s.remove(),o&&0===o.children.length&&o.remove()},300)}return r.type="button",r.className="wgs-toast-close",r.innerHTML="&times;",r.setAttribute("aria-label","Zavřít"),s.appendChild(i),s.appendChild(r),o.appendChild(s),requestAnimationFrame(()=>{s.classList.add("wgs-toast-visible")}),r.addEventListener("click",a),n>0&&setTimeout(a,n),s}function toBase64(t){return new Promise((e,n)=>{const o=new FileReader;o.onload=()=>e(o.result),o.onerror=n,o.readAsDataURL(t)})}function formatNumber(t){return null==t?"0":new Intl.NumberFormat("cs-CZ").format(t)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initEventDelegation):initEventDelegation(),window.Utils.ActionRegistry=ActionRegistry,window.Utils.registerAction=ActionRegistry.register.bind(ActionRegistry),window.wgsConfirm=wgsConfirm,window.Utils.wgsConfirm=wgsConfirm,wgsToast.success=(t,e)=>wgsToast(t,"success",e),wgsToast.error=(t,e)=>wgsToast(t,"error",e||5e3),wgsToast.warning=(t,e)=>wgsToast(t,"warning",e||4e3),wgsToast.info=(t,e)=>wgsToast(t,"info",e),window.wgsToast=wgsToast,window.Utils.wgsToast=wgsToast,window.toBase64=toBase64,window.Utils.toBase64=toBase64,window.formatNumber=formatNumber,window.Utils.formatNumber=formatNumber,window.goBack=function(){window.history.length>1?window.history.back():window.location.href="/"},window.historyBack=window.goBack,window.reloadPage=function(){window.location.reload()},window.printPage=function(){window.print()},window.presmerujNaLogin=function(){window.location.href="/login.php"},window.Utils&&window.Utils.ActionRegistry&&(window.Utils.ActionRegistry.register("goBack",window.goBack),window.Utils.ActionRegistry.register("historyBack",window.goBack),window.Utils.ActionRegistry.register("reloadPage",window.reloadPage),window.Utils.ActionRegistry.register("printPage",window.printPage),window.Utils.ActionRegistry.register("presmerujNaLogin",window.presmerujNaLogin));